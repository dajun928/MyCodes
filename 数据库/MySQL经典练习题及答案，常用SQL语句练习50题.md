https://blog.csdn.net/qq_41936662/article/details/80393172

转MySQL经典练习题及答案，常用SQL语句练习50题2018年05月21日 15:45:33 [我疯](https://me.csdn.net/qq_41936662) 阅读数：25364表名和字段–1.学生表 Student(s_id,s_name,s_birth,s_sex) –学生编号,学生姓名, 出生年月,学生性别 –2.课程表 Course(c_id,c_name,t_id) – –课程编号, 课程名称, 教师编号 –3.教师表 Teacher(t_id,t_name) –教师编号,教师姓名 –4.成绩表 Score(s_id,c_id,s_score) –学生编号,课程编号,分数测试数据1--建表2--学生表3CREATE TABLE `Student`(4`s_id` VARCHAR(20),5`s_name` VARCHAR(20) NOT NULL DEFAULT '',6`s_birth` VARCHAR(20) NOT NULL DEFAULT '',7`s_sex` VARCHAR(10) NOT NULL DEFAULT '',8PRIMARY KEY(`s_id`)9);10--课程表11CREATE TABLE `Course`(12`c_id` VARCHAR(20),13`c_name` VARCHAR(20) NOT NULL DEFAULT '',14`t_id` VARCHAR(20) NOT NULL,15PRIMARY KEY(`c_id`)16);17--教师表18CREATE TABLE `Teacher`(19`t_id` VARCHAR(20),20`t_name` VARCHAR(20) NOT NULL DEFAULT '',21PRIMARY KEY(`t_id`)22);23--成绩表24CREATE TABLE `Score`(25`s_id` VARCHAR(20),26`c_id` VARCHAR(20),27`s_score` INT(3),28PRIMARY KEY(`s_id`,`c_id`)29);30--插入学生表测试数据31insert into Student values('01' , '赵雷' , '1990-01-01' , '男');32insert into Student values('02' , '钱电' , '1990-12-21' , '男');33insert into Student values('03' , '孙风' , '1990-05-20' , '男');34insert into Student values('04' , '李云' , '1990-08-06' , '男');35insert into Student values('05' , '周梅' , '1991-12-01' , '女');36insert into Student values('06' , '吴兰' , '1992-03-01' , '女');37insert into Student values('07' , '郑竹' , '1989-07-01' , '女');38insert into Student values('08' , '王菊' , '1990-01-20' , '女');39--课程表测试数据40insert into Course values('01' , '语文' , '02');41insert into Course values('02' , '数学' , '01');42insert into Course values('03' , '英语' , '03');4344--教师表测试数据45insert into Teacher values('01' , '张三');46insert into Teacher values('02' , '李四');47insert into Teacher values('03' , '王五');4849--成绩表测试数据50insert into Score values('01' , '01' , 80);51insert into Score values('01' , '02' , 90);52insert into Score values('01' , '03' , 99);53insert into Score values('02' , '01' , 70);54insert into Score values('02' , '02' , 60);55insert into Score values('02' , '03' , 80);56insert into Score values('03' , '01' , 80);57insert into Score values('03' , '02' , 80);58insert into Score values('03' , '03' , 80);59insert into Score values('04' , '01' , 50);60insert into Score values('04' , '02' , 30);61insert into Score values('04' , '03' , 20);62insert into Score values('05' , '01' , 76);63insert into Score values('05' , '02' , 87);64insert into Score values('06' , '01' , 31);65insert into Score values('06' , '03' , 34);66insert into Score values('07' , '02' , 89);67insert into Score values('07' , '03' , 98);登录后复制练习题和sql语句1-- 1、查询"01"课程比"02"课程成绩高的学生的信息及课程分数23select a.* ,b.s_score as 01_score,c.s_score as 02_score from4student a5join score b on a.s_id=b.s_id and b.c_id='01'6left join score c on a.s_id=c.s_id and c.c_id='02' or c.c_id = NULL where b.s_score>c.s_score789-- 2、查询"01"课程比"02"课程成绩低的学生的信息及课程分数1011select a.* ,b.s_score as 01_score,c.s_score as 02_score from12student a left join score b on a.s_id=b.s_id and b.c_id='01' or b.c_id=NULL13join score c on a.s_id=c.s_id and c.c_id='02' where b.s_score<c.s_score141516-- 3、查询平均成绩大于等于60分的同学的学生编号和学生姓名和平均成绩17select b.s_id,b.s_name,ROUND(AVG(a.s_score),2) as avg_score from18student b19join score a on b.s_id = a.s_id20GROUP BY b.s_id,b.s_name HAVING ROUND(AVG(a.s_score),2)>=60;212223-- 4、查询平均成绩小于60分的同学的学生编号和学生姓名和平均成绩24-- (包括有成绩的和无成绩的)2526select b.s_id,b.s_name,ROUND(AVG(a.s_score),2) as avg_score from27student b28left join score a on b.s_id = a.s_id29GROUP BY b.s_id,b.s_name HAVING ROUND(AVG(a.s_score),2)<6030union31select a.s_id,a.s_name,0 as avg_score from32student a33where a.s_id not in (34select distinct s_id from score);353637-- 5、查询所有同学的学生编号、学生姓名、选课总数、所有课程的总成绩38select a.s_id,a.s_name,count(b.c_id) as sum_course,sum(b.s_score) as sum_score from39student a40left join score b on a.s_id=b.s_id41GROUP BY a.s_id,a.s_name;424344-- 6、查询"李"姓老师的数量45select count(t_id) from teacher where t_name like '李%';4647-- 7、查询学过"张三"老师授课的同学的信息48select a.* from49student a50join score b on a.s_id=b.s_id where b.c_id in(51select c_id from course where t_id =(52select t_id from teacher where t_name = '张三'));5354-- 8、查询没学过"张三"老师授课的同学的信息55select * from56student c57where c.s_id not in(58select a.s_id from student a join score b on a.s_id=b.s_id where b.c_id in(59select c_id from course where t_id =(60select t_id from teacher where t_name = '张三')));61-- 9、查询学过编号为"01"并且也学过编号为"02"的课程的同学的信息6263select a.* from64student a,score b,score c65where a.s_id = b.s_id and a.s_id = c.s_id and b.c_id='01' and c.c_id='02';6667-- 10、查询学过编号为"01"但是没有学过编号为"02"的课程的同学的信息6869select a.* from70student a71where a.s_id in (select s_id from score where c_id='01' ) and a.s_id not in(select s_id from score where c_id='02')727374-- 11、查询没有学全所有课程的同学的信息7576select s.* from77student s where s.s_id in(78select s_id from score where s_id not in(79select a.s_id from score a80join score b on a.s_id = b.s_id and b.c_id='02'81join score c on a.s_id = c.s_id and c.c_id='03'82where a.c_id='01'))8384-- 12、查询至少有一门课与学号为"01"的同学所学相同的同学的信息8586select * from student where s_id in(87select distinct a.s_id from score a where a.c_id in(select a.c_id from score a where a.s_id='01')88);8990-- 13、查询和"01"号的同学学习的课程完全相同的其他同学的信息9192select a.* from student a where a.s_id in(93select distinct s_id from score where s_id!='01' and c_id in(select c_id from score where s_id='01')94group by s_id95having count(1)=(select count(1) from score where s_id='01'));96-- 14、查询没学过"张三"老师讲授的任一门课程的学生姓名97select a.s_name from student a where a.s_id not in (98select s_id from score where c_id =99(select c_id from course where t_id =(100select t_id from teacher where t_name = '张三'))101group by s_id);102103-- 15、查询两门及其以上不及格课程的同学的学号，姓名及其平均成绩104select a.s_id,a.s_name,ROUND(AVG(b.s_score)) from105student a106left join score b on a.s_id = b.s_id107where a.s_id in(108select s_id from score where s_score<60 GROUP BY s_id having count(1)>=2)109GROUP BY a.s_id,a.s_name110111-- 16、检索"01"课程分数小于60，按分数降序排列的学生信息112select a.*,b.c_id,b.s_score from113student a,score b114where a.s_id = b.s_id and b.c_id='01' and b.s_score<60 ORDER BY b.s_score DESC;115116-- 17、按平均成绩从高到低显示所有学生的所有课程的成绩以及平均成绩117select a.s_id,(select s_score from score where s_id=a.s_id and c_id='01') as 语文,118(select s_score from score where s_id=a.s_id and c_id='02') as 数学,119(select s_score from score where s_id=a.s_id and c_id='03') as 英语,120round(avg(s_score),2) as 平均分 from score a GROUP BY a.s_id ORDER BY 平均分 DESC;121122-- 18.查询各科成绩最高分、最低分和平均分：以如下形式显示：课程ID，课程name，最高分，最低分，平均分，及格率，中等率，优良率，优秀率123--及格为>=60，中等为：70-80，优良为：80-90，优秀为：>=90124select a.c_id,b.c_name,MAX(s_score),MIN(s_score),ROUND(AVG(s_score),2),125ROUND(100*(SUM(case when a.s_score>=60 then 1 else 0 end)/SUM(case when a.s_score then 1 else 0 end)),2) as 及格率,126ROUND(100*(SUM(case when a.s_score>=70 and a.s_score<=80 then 1 else 0 end)/SUM(case when a.s_score then 1 else 0 end)),2) as 中等率,127ROUND(100*(SUM(case when a.s_score>=80 and a.s_score<=90 then 1 else 0 end)/SUM(case when a.s_score then 1 else 0 end)),2) as 优良率,128ROUND(100*(SUM(case when a.s_score>=90 then 1 else 0 end)/SUM(case when a.s_score then 1 else 0 end)),2) as 优秀率129from score a left join course b on a.c_id = b.c_id GROUP BY a.c_id,b.c_name130131-- 19、按各科成绩进行排序，并显示排名(实现不完全)132-- mysql没有rank函数133select a.s_id,a.c_id,134@i:=@i +1 as i保留排名,135@k:=(case when @score=a.s_score then @k else @i end) as rank不保留排名,136@score:=a.s_score as score137from (138select s_id,c_id,s_score from score WHERE c_id='01' GROUP BY s_id,c_id,s_score ORDER BY s_score DESC139)a,(select @k:=0,@i:=0,@score:=0)s140union141select a.s_id,a.c_id,142@i:=@i +1 as i,143@k:=(case when @score=a.s_score then @k else @i end) as rank,144@score:=a.s_score as score145from (146select s_id,c_id,s_score from score WHERE c_id='02' GROUP BY s_id,c_id,s_score ORDER BY s_score DESC147)a,(select @k:=0,@i:=0,@score:=0)s148union149select a.s_id,a.c_id,150@i:=@i +1 as i,151@k:=(case when @score=a.s_score then @k else @i end) as rank,152@score:=a.s_score as score153from (154select s_id,c_id,s_score from score WHERE c_id='03' GROUP BY s_id,c_id,s_score ORDER BY s_score DESC155)a,(select @k:=0,@i:=0,@score:=0)s156157-- 20、查询学生的总成绩并进行排名158select a.s_id,159@i:=@i+1 as i,160@k:=(case when @score=a.sum_score then @k else @i end) as rank,161@score:=a.sum_score as score162from (select s_id,SUM(s_score) as sum_score from score GROUP BY s_id ORDER BY sum_score DESC)a,163(select @k:=0,@i:=0,@score:=0)s164165-- 21、查询不同老师所教不同课程平均分从高到低显示166167select a.t_id,c.t_name,a.c_id,ROUND(avg(s_score),2) as avg_score from course a168left join score b on a.c_id=b.c_id169left join teacher c on a.t_id=c.t_id170GROUP BY a.c_id,a.t_id,c.t_name ORDER BY avg_score DESC;171-- 22、查询所有课程的成绩第2名到第3名的学生信息及该课程成绩172173select d.*,c.排名,c.s_score,c.c_id from (174select a.s_id,a.s_score,a.c_id,@i:=@i+1 as 排名 from score a,(select @i:=0)s where a.c_id='01'175)c176left join student d on c.s_id=d.s_id177where 排名 BETWEEN 2 AND 3178UNION179select d.*,c.排名,c.s_score,c.c_id from (180select a.s_id,a.s_score,a.c_id,@j:=@j+1 as 排名 from score a,(select @j:=0)s where a.c_id='02'181)c182left join student d on c.s_id=d.s_id183where 排名 BETWEEN 2 AND 3184UNION185select d.*,c.排名,c.s_score,c.c_id from (186select a.s_id,a.s_score,a.c_id,@k:=@k+1 as 排名 from score a,(select @k:=0)s where a.c_id='03'187)c188left join student d on c.s_id=d.s_id189where 排名 BETWEEN 2 AND 3;190191192-- 23、统计各科成绩各分数段人数：课程编号,课程名称,[100-85],[85-70],[70-60],[0-60]及所占百分比193194195select distinct f.c_name,a.c_id,b.`85-100`,b.百分比,c.`70-85`,c.百分比,d.`60-70`,d.百分比,e.`0-60`,e.百分比 from score a196left join (select c_id,SUM(case when s_score >85 and s_score <=100 then 1 else 0 end) as `85-100`,197ROUND(100*(SUM(case when s_score >85 and s_score <=100 then 1 else 0 end)/count(*)),2) as 百分比198from score GROUP BY c_id)b on a.c_id=b.c_id199left join (select c_id,SUM(case when s_score >70 and s_score <=85 then 1 else 0 end) as `70-85`,200ROUND(100*(SUM(case when s_score >70 and s_score <=85 then 1 else 0 end)/count(*)),2) as 百分比201from score GROUP BY c_id)c on a.c_id=c.c_id202left join (select c_id,SUM(case when s_score >60 and s_score <=70 then 1 else 0 end) as `60-70`,203ROUND(100*(SUM(case when s_score >60 and s_score <=70 then 1 else 0 end)/count(*)),2) as 百分比204from score GROUP BY c_id)d on a.c_id=d.c_id205left join (select c_id,SUM(case when s_score >=0 and s_score <=60 then 1 else 0 end) as `0-60`,206ROUND(100*(SUM(case when s_score >=0 and s_score <=60 then 1 else 0 end)/count(*)),2) as 百分比207from score GROUP BY c_id)e on a.c_id=e.c_id208left join course f on a.c_id = f.c_id209210-- 24、查询学生平均成绩及其名次211212select a.s_id,213@i:=@i+1 as '不保留空缺排名',214@k:=(case when @avg_score=a.avg_s then @k else @i end) as '保留空缺排名',215@avg_score:=avg_s as '平均分'216from (select s_id,ROUND(AVG(s_score),2) as avg_s from score GROUP BY s_id)a,(select @avg_score:=0,@i:=0,@k:=0)b;217-- 25、查询各科成绩前三名的记录218-- 1.选出b表比a表成绩大的所有组219-- 2.选出比当前id成绩大的 小于三个的220select a.s_id,a.c_id,a.s_score from score a221left join score b on a.c_id = b.c_id and a.s_score<b.s_score222group by a.s_id,a.c_id,a.s_score HAVING COUNT(b.s_id)<3223ORDER BY a.c_id,a.s_score DESC224225-- 26、查询每门课程被选修的学生数226227select c_id,count(s_id) from score a GROUP BY c_id228229-- 27、查询出只有两门课程的全部学生的学号和姓名230select s_id,s_name from student where s_id in(231select s_id from score GROUP BY s_id HAVING COUNT(c_id)=2);232233-- 28、查询男生、女生人数234select s_sex,COUNT(s_sex) as 人数 from student GROUP BY s_sex235236-- 29、查询名字中含有"风"字的学生信息237238select * from student where s_name like '%风%';239240-- 30、查询同名同性学生名单，并统计同名人数241242select a.s_name,a.s_sex,count(*) from student a JOIN243student b on a.s_id !=b.s_id and a.s_name = b.s_name and a.s_sex = b.s_sex244GROUP BY a.s_name,a.s_sex245246247248-- 31、查询1990年出生的学生名单249250select s_name from student where s_birth like '1990%'251252-- 32、查询每门课程的平均成绩，结果按平均成绩降序排列，平均成绩相同时，按课程编号升序排列253254select c_id,ROUND(AVG(s_score),2) as avg_score from score GROUP BY c_id ORDER BY avg_score DESC,c_id ASC255256-- 33、查询平均成绩大于等于85的所有学生的学号、姓名和平均成绩257258select a.s_id,b.s_name,ROUND(avg(a.s_score),2) as avg_score from score a259left join student b on a.s_id=b.s_id GROUP BY s_id HAVING avg_score>=85260261-- 34、查询课程名称为"数学"，且分数低于60的学生姓名和分数262263select a.s_name,b.s_score from score b LEFT JOIN student a on a.s_id=b.s_id where b.c_id=(264select c_id from course where c_name ='数学') and b.s_score<60265266-- 35、查询所有学生的课程及分数情况；267268269select a.s_id,a.s_name,270SUM(case c.c_name when '语文' then b.s_score else 0 end) as '语文',271SUM(case c.c_name when '数学' then b.s_score else 0 end) as '数学',272SUM(case c.c_name when '英语' then b.s_score else 0 end) as '英语',273SUM(b.s_score) as '总分'274from student a left join score b on a.s_id = b.s_id275left join course c on b.c_id = c.c_id276GROUP BY a.s_id,a.s_name277278279-- 36、查询任何一门课程成绩在70分以上的姓名、课程名称和分数；280select a.s_name,b.c_name,c.s_score from course b left join score c on b.c_id = c.c_id281left join student a on a.s_id=c.s_id where c.s_score>=70282283284285-- 37、查询不及格的课程286select a.s_id,a.c_id,b.c_name,a.s_score from score a left join course b on a.c_id = b.c_id287where a.s_score<60288289--38、查询课程编号为01且课程成绩在80分以上的学生的学号和姓名；290select a.s_id,b.s_name from score a LEFT JOIN student b on a.s_id = b.s_id291where a.c_id = '01' and a.s_score>80292293-- 39、求每门课程的学生人数294select count(*) from score GROUP BY c_id;295296-- 40、查询选修"张三"老师所授课程的学生中，成绩最高的学生信息及其成绩297298299-- 查询老师id300select c_id from course c,teacher d where c.t_id=d.t_id and d.t_name='张三'301-- 查询最高分（可能有相同分数）302select MAX(s_score) from score where c_id='02'303-- 查询信息304select a.*,b.s_score,b.c_id,c.c_name from student a305LEFT JOIN score b on a.s_id = b.s_id306LEFT JOIN course c on b.c_id=c.c_id307where b.c_id =(select c_id from course c,teacher d where c.t_id=d.t_id and d.t_name='张三')308and b.s_score in (select MAX(s_score) from score where c_id='02')309310311-- 41、查询不同课程成绩相同的学生的学生编号、课程编号、学生成绩312select DISTINCT b.s_id,b.c_id,b.s_score from score a,score b where a.c_id != b.c_id and a.s_score = b.s_score313314315-- 42、查询每门功成绩最好的前两名316-- 牛逼的写法317select a.s_id,a.c_id,a.s_score from score a318where (select COUNT(1) from score b where b.c_id=a.c_id and b.s_score>=a.s_score)<=2 ORDER BY a.c_id319320321-- 43、统计每门课程的学生选修人数（超过5人的课程才统计）。要求输出课程号和选修人数，查询结果按人数降序排列，若人数相同，按课程号升序排列322select c_id,count(*) as total from score GROUP BY c_id HAVING total>5 ORDER BY total,c_id ASC323324-- 44、检索至少选修两门课程的学生学号325select s_id,count(*) as sel from score GROUP BY s_id HAVING sel>=2326327-- 45、查询选修了全部课程的学生信息328select * from student where s_id in(329select s_id from score GROUP BY s_id HAVING count(*)=(select count(*) from course))330331332--46、查询各学生的年龄333-- 按照出生日期来算，当前月日 < 出生年月的月日则，年龄减一334335select s_birth,(DATE_FORMAT(NOW(),'%Y')-DATE_FORMAT(s_birth,'%Y') -336(case when DATE_FORMAT(NOW(),'%m%d')>DATE_FORMAT(s_birth,'%m%d') then 0 else 1 end)) as age337from student;338339340-- 47、查询本周过生日的学生341select * from student where WEEK(DATE_FORMAT(NOW(),'%Y%m%d'))=WEEK(s_birth)342select * from student where YEARWEEK(s_birth)=YEARWEEK(DATE_FORMAT(NOW(),'%Y%m%d'))343344select WEEK(DATE_FORMAT(NOW(),'%Y%m%d'))345346-- 48、查询下周过生日的学生347select * from student where WEEK(DATE_FORMAT(NOW(),'%Y%m%d'))+1 =WEEK(s_birth)348349-- 49、查询本月过生日的学生350351select * from student where MONTH(DATE_FORMAT(NOW(),'%Y%m%d')) =MONTH(s_birth)352353-- 50、查询下月过生日的学生354select * from student where MONTH(DATE_FORMAT(NOW(),'%Y%m%d'))+1 =MONTH(s_birth)